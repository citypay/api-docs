
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>CityPay Payment API</title>
    <link href="images/favicon-c177ed8f.ico" rel="icon" type="image/ico" />
    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .cm {
  color: #999988;
  font-style: italic;
}
.highlight .cp {
  color: #999999;
  font-weight: bold;
}
.highlight .c1 {
  color: #999988;
  font-style: italic;
}
.highlight .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #999988;
  font-style: italic;
}
.highlight .err {
  color: #a61717;
  background-color: #e3d2d2;
}
.highlight .gd {
  color: #000000;
  background-color: #ffdddd;
}
.highlight .ge {
  color: #000000;
  font-style: italic;
}
.highlight .gr {
  color: #aa0000;
}
.highlight .gh {
  color: #999999;
}
.highlight .gi {
  color: #000000;
  background-color: #ddffdd;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
  font-weight: bold;
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .gt {
  color: #aa0000;
}
.highlight .kc {
  color: #000000;
  font-weight: bold;
}
.highlight .kd {
  color: #000000;
  font-weight: bold;
}
.highlight .kn {
  color: #000000;
  font-weight: bold;
}
.highlight .kp {
  color: #000000;
  font-weight: bold;
}
.highlight .kr {
  color: #000000;
  font-weight: bold;
}
.highlight .kt {
  color: #445588;
  font-weight: bold;
}
.highlight .k, .highlight .kv {
  color: #000000;
  font-weight: bold;
}
.highlight .mf {
  color: #009999;
}
.highlight .mh {
  color: #009999;
}
.highlight .il {
  color: #009999;
}
.highlight .mi {
  color: #009999;
}
.highlight .mo {
  color: #009999;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #009999;
}
.highlight .sb {
  color: #d14;
}
.highlight .sc {
  color: #d14;
}
.highlight .sd {
  color: #d14;
}
.highlight .s2 {
  color: #d14;
}
.highlight .se {
  color: #d14;
}
.highlight .sh {
  color: #d14;
}
.highlight .si {
  color: #d14;
}
.highlight .sx {
  color: #d14;
}
.highlight .sr {
  color: #009926;
}
.highlight .s1 {
  color: #d14;
}
.highlight .ss {
  color: #990073;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #d14;
}
.highlight .na {
  color: #008080;
}
.highlight .bp {
  color: #999999;
}
.highlight .nb {
  color: #0086B3;
}
.highlight .nc {
  color: #445588;
  font-weight: bold;
}
.highlight .no {
  color: #008080;
}
.highlight .nd {
  color: #3c5d5d;
  font-weight: bold;
}
.highlight .ni {
  color: #800080;
}
.highlight .ne {
  color: #990000;
  font-weight: bold;
}
.highlight .nf, .highlight .fm {
  color: #990000;
  font-weight: bold;
}
.highlight .nl {
  color: #990000;
  font-weight: bold;
}
.highlight .nn {
  color: #555555;
}
.highlight .nt {
  color: #000080;
}
.highlight .vc {
  color: #008080;
}
.highlight .vg {
  color: #008080;
}
.highlight .vi {
  color: #008080;
}
.highlight .nv, .highlight .vm {
  color: #008080;
}
.highlight .ow {
  color: #000000;
  font-weight: bold;
}
.highlight .o {
  color: #000000;
  font-weight: bold;
}
.highlight .w {
  color: #bbbbbb;
}
.highlight {
  background-color: #f8f8f8;
}
    </style>
    <link href="stylesheets/screen-d5b02caa.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-836f82df.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e9bde216.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/prism.min.js" integrity="sha512-UOoJElONeUNzQbbKQbjldDf9MwOHqxNz49NNJJ1d90yp+X9edsHyJoAs6O4K19CZGaIdjI5ohK+O2y5lBTW6uQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/components/prism-bash.min.js" integrity="sha512-35RBtvuCKWANuRid6RXP2gYm4D5RMieVL/xbp6KiMXlIqgNrI7XRUh9HurE8lKHW4aRpC0TZU3ZfqG8qmQ35zA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/9000.0.1/themes/prism-tomorrow.min.css" integrity="sha512-kSwGoyIkfz4+hMo5jkJngSByil9jxJPKbweYec/UgS+S1EgE45qm4Gea7Ks2oxQ7qiYyyZRn66A9df2lMtjIsw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  </head>

  <body class="index" data-languages="[&quot;json&quot;,&quot;xml&quot;]">
    <div class="toc-wrapper">
      <img src="images/citypay-logo-23676e0b.svg" class="cplogo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
              <a href="#" data-language-name="xml">xml</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#citypay-payment-api" class="toc-h1 toc-link" data-title="CityPay Payment API">CityPay Payment API</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#compliance-and-security" class="toc-h2 toc-link" data-title="Compliance and Security">Compliance and Security</a>
                  </li>
                  <li>
                    <a href="#base-urls" class="toc-h2 toc-link" data-title="Base URLs">Base URLs</a>
                  </li>
                  <li>
                    <a href="#contact-details" class="toc-h2 toc-link" data-title="Contact Details">Contact Details</a>
                  </li>
                  <li>
                    <a href="#authentication" class="toc-h2 toc-link" data-title="Authentication">Authentication</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#api-definitions" class="toc-h1 toc-link" data-title="API Definitions">API Definitions</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#response-codes" class="toc-h2 toc-link" data-title="Response Codes">Response Codes</a>
                  </li>
                  <li>
                    <a href="#auth-result-codes" class="toc-h2 toc-link" data-title="Auth Result Codes">Auth Result Codes</a>
                  </li>
                  <li>
                    <a href="#avs-result-codes" class="toc-h2 toc-link" data-title="AVS Result Codes">AVS Result Codes</a>
                  </li>
                  <li>
                    <a href="#csc-result-codes" class="toc-h2 toc-link" data-title="CSC Result Codes">CSC Result Codes</a>
                  </li>
                  <li>
                    <a href="#enabled-tls-ciphers" class="toc-h2 toc-link" data-title="Enabled TLS Ciphers">Enabled TLS Ciphers</a>
                  </li>
                  <li>
                    <a href="#timeout-handling" class="toc-h2 toc-link" data-title="Timeout Handling">Timeout Handling</a>
                  </li>
                  <li>
                    <a href="#testing-best-practices" class="toc-h2 toc-link" data-title="Testing Best Practices">Testing Best Practices</a>
                  </li>
                  <li>
                    <a href="#avs-checking" class="toc-h2 toc-link" data-title="AVS Checking">AVS Checking</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='mailto:support@citypay.com'>Any Integration Questions?</a></li>
            <li>V6.6.25 2024-01-16</li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <img src="images/header-4aeb62fd.png" width="100%" alt="header image" />
        <h1 id='citypay-payment-api'>CityPay Payment API</h1>
<p>Version: 6.6.25
Last Updated: 2024-01-16</p>

<p>This CityPay API is a HTTP RESTful payment API used for direct server to server transactional processing. It
provides a number of payment mechanisms including: Internet, MOTO, Continuous Authority transaction processing,
3-D Secure decision handling using RFA Secure, Authorisation, Refunding, Pre-Authorisation, Cancellation/Voids and
Completion processing. The API is also capable of tokinsed payments using Card Holder Accounts.</p>
<h2 id='compliance-and-security'>Compliance and Security</h2>
<p>Your application will need to adhere to PCI-DSS standards to operate safely and to meet requirements set out by 
Visa and MasterCard and the PCI Security Standards Council. These include</p>

<ul>
<li>Data must be collected using TLS version 1.2 using <a href="#enabled-tls-ciphers">strong cryptography</a>. We will not accept calls to our API at
lower grade encryption levels. We regularly scan our TLS endpoints for vulnerabilities and perform TLS assessments
as part of our compliance program.</li>
<li>The application must not store sensitive card holder data (CHD) such as the card security code (CSC) or
primary access number (PAN)</li>
<li>The application must not display the full card number on receipts, it is recommended to mask the PAN
and show the last 4 digits. The API will return this for you for ease of receipt creation</li>
<li>If you are developing a website, you will be required to perform regular scans on the network where you host the
application to meet your compliance obligations</li>
<li>You will be required to be PCI Compliant and the application must adhere to the security standard. Further information
is available from <a href="https://www.pcisecuritystandards.org/">https://www.pcisecuritystandards.org/</a></li>
<li>The API verifies that the request is for a valid account and originates from a trusted source using the remote IP
address. Our application firewalls analyse data that may be an attempt to break a large number of security common
security vulnerabilities.</li>
</ul>
<h2 id='base-urls'>Base URLs</h2>
<table>
<tr><td> Production processing endpoint </td><td><code>https://api.citypay.com</code></td></tr> 
<tr><td> Testing service returning test results for all transactions </td><td><code>https://sandbox.citypay.com</code></td></tr> 

</table>
<h2 id='contact-details'>Contact Details</h2>
<p>Please contact CityPay Support</p>

<ul>
<li>At our online <a href="https://citypay.atlassian.net/servicedesk/customer/portal/1">CityPay Service Desk</a></li>
<li>Or via our website at <a href="https://citypay.com/customer-centre/technical-support.html">https://citypay.com/customer-centre/technical-support.html</a></li>
</ul>

<p>For any transaction investigations or integration support, please provide your</p>

<ul>
<li>merchant id</li>
<li>a context id or identifier</li>
<li>a date and time of the request</li>
</ul>
<h2 id='authentication'>Authentication</h2><h3 id='api-key'>API Key</h3>
<p><strong>cp-api-key</strong></p>

<p>header <code>cp-api-key</code></p>

<p>The <code>cp-api-key</code> authentication header is required for all payment processing access.
All calls using this key will be validated against an acceptance list of IP addresses
and calls are scrutinised by the CityPay application firewall for security protection
and attack mitigation.</p>

<p>A key has been designed to:
- be temporal and time based. The key rotates frequently to protect against replay attacks and to ensure a
  computation derives your client details from the request
- to remain secret, the key value is your access permission to process transactions and
  although we have preventative measures to protect the key, undue exposure is not desirable
- to allow processing against multiple merchant accounts that belong to your CityPay account.
- to use a HTTP header value to protect undue logging mechanisms from logging data packet values and
  logically seperates authentication concerns from the body of data.
- keys typically have a TTL of 5 minutes in production and 20 minutes in Sandbox.
- keys should be rotated often and is recommended on each API call</p>

<p>A valid key is programmatically generated using</p>

<ul>
<li>your client id</li>
<li>your client key</li>
</ul>

<p>The algorithm for generating a key is</p>

<ol>
<li>create a 256 bit <code>nonce</code> value such i.e. <code>ACB875AEF083DE292299BD69FCDEB5C5</code></li>
<li>create a <code>dt</code> value which is the current date and time in the format <code>yyyyMMddHHmm</code> convert to bytes from a hex representation</li>
<li>generate a HmacSHA256 <code>hash</code> for the client licence key using a concatenation of clientid, nonce, dt</li>
<li>create a packet value of <code>clientId</code>, <code>nonce</code>, and <code>hash</code> delimited by <code>\u003A</code></li>
<li>Base64 encode the packet</li>
</ol>

<blockquote>
<p>The following example uses JavaScript and CryptoJS</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="k">export</span> <span class="kd">function</span> <span class="nx">generateApiKey</span><span class="p">(</span><span class="nx">clientId</span><span class="p">,</span> <span class="nx">licenceKey</span><span class="p">,</span> <span class="nx">nonce</span><span class="p">,</span> <span class="nx">dt</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">())</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">nonce</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">nonce</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">random</span><span class="p">(</span><span class="mi">128</span> <span class="o">/</span> <span class="mi">8</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">nonce</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">nonce</span> <span class="o">=</span> <span class="nx">Hex</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">nonce</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="dl">"</span><span class="s2">Unsupported nonce type</span><span class="dl">"</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="kd">const</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">Utf8</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">clientId</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">nonce</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">lib</span><span class="p">.</span><span class="nx">WordArray</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">dtToBuffer</span><span class="p">(</span><span class="nx">dt</span><span class="p">)));</span>
  <span class="kd">const</span> <span class="nx">hash</span> <span class="o">=</span> <span class="nx">HmacSHA256</span><span class="p">(</span><span class="nx">msg</span><span class="p">,</span> <span class="nx">Utf8</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">licenceKey</span><span class="p">));</span>
  <span class="kd">const</span> <span class="nx">packet</span> <span class="o">=</span> <span class="nx">Utf8</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">clientId</span> <span class="o">+</span> <span class="dl">'</span><span class="se">\</span><span class="s1">u003A</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">nonce</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="nx">Hex</span><span class="p">).</span><span class="nx">toUpperCase</span><span class="p">()</span> <span class="o">+</span> <span class="dl">'</span><span class="se">\</span><span class="s1">u003A</span><span class="dl">'</span><span class="p">).</span><span class="nx">concat</span><span class="p">(</span><span class="nx">hash</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">Base64</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">packet</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<blockquote>
<p>Example values for unit testing:</p>
</blockquote>
<div class="highlight"><pre class="highlight plaintext"><code>  let exampleNonce = "ACB875AEF083DE292299BD69FCDEB5C5";
  let exampleDate = new Date(2020, 0, 1, 9, 23, 0, 0);
  let apiKey = generateApiKey("Dummy", "7G79TG62BAJTK669", exampleNonce, exampleDate);
  expect(apiKey).toBe('RHVtbXk6QUNCODc1QUVGMDgzREUyOTIyOTlCRDY5RkNERUI1QzU6tleiG2iztdBCGz64E3/HUhfKIdGWr3VnEtu2IkcmFjA=');
</code></pre></div>
<aside class="notice">
We have example code in varying languages, please consult with your account and integration point of contact for details.
</aside>
<h3 id='api-key-2'>API Key</h3>
<p><strong>cp-domain-key</strong></p>

<p>path <code>cp-domain-key</code></p>

<p>The <code>cp-domain-key</code> authentication is required for host based authentication where integrations
are over direct HTTPS calls.
Calls using this key will be validated against a prefixed list of host addresses and the <code>Origin</code> or <code>Referer</code>
header of the HTTP call checked.
All calls are scrutinised by the CityPay application firewall for security protection
and attack mitigation.</p>

<p>A key has been designed to:
- be added to a HTML Form as an authentication token for a pre-registered domain.
- Allow for the registration of multiple domains
- Only calls which are host based may use a domain key</p>

<ul>
<li>your merchant id</li>
<li>your access/licence key</li>
</ul>
<h1 id='api-definitions'>API Definitions</h1><h2 id='response-codes'>Response Codes</h2>
<p>The CityPay Payment API uses the following response codes in its response messages:</p>

<table><thead>
<tr>
<th>Code</th>
<th>Message</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>000</code></td>
<td>Accepted Transaction</td>
<td>The transaction was accepted.</td>
</tr>
<tr>
<td><code>001</code></td>
<td>Test Transaction</td>
<td>The transaction was marked as being a test transaction and was successfully returned.</td>
</tr>
<tr>
<td><code>002</code></td>
<td>Accepted Refund</td>
<td>The refund was successful</td>
</tr>
<tr>
<td><code>003</code></td>
<td>Accepted Void Transaction</td>
<td>The transaction was successfully voided</td>
</tr>
<tr>
<td><code>011</code></td>
<td>Signature Verification</td>
<td></td>
</tr>
<tr>
<td><code>012</code></td>
<td>Hold</td>
<td></td>
</tr>
<tr>
<td><code>013</code></td>
<td>Pin Invalid</td>
<td></td>
</tr>
<tr>
<td><code>014</code></td>
<td>Pin Retry</td>
<td></td>
</tr>
<tr>
<td><code>015</code></td>
<td>Pin Tries Exceeded</td>
<td></td>
</tr>
<tr>
<td><code>030</code></td>
<td>Cannot Authorise</td>
<td>Invalid Card Number</td>
</tr>
<tr>
<td><code>031</code></td>
<td>Cannot Authorise</td>
<td>Expired Card</td>
</tr>
<tr>
<td><code>032</code></td>
<td>Processing Server Unavailable</td>
<td>A delegating processing server was unavailable and failover servers were retried, processing cannot continue</td>
</tr>
<tr>
<td><code>040</code></td>
<td>Transaction verification passed</td>
<td>The transaction returned was verified succesfully</td>
</tr>
<tr>
<td><code>041</code></td>
<td>Transaction verification failed</td>
<td>The transaction returned has failed to be verified</td>
</tr>
<tr>
<td><code>044</code></td>
<td>Ping OK</td>
<td>A ping request was received and the server is replying to it</td>
</tr>
<tr>
<td><code>050</code></td>
<td>Waiting Authorisation</td>
<td></td>
</tr>
<tr>
<td><code>064</code></td>
<td>Mandated Decline</td>
<td>The transaction was declined due to an enforced mandate by the card scheme or acquirer</td>
</tr>
<tr>
<td><code>065</code></td>
<td>Soft Declined</td>
<td>The transaction was declined however may be reprocessed with authentication</td>
</tr>
<tr>
<td><code>071</code></td>
<td>Transaction already voided</td>
<td>The transaction was previously voided</td>
</tr>
<tr>
<td><code>072</code></td>
<td>Transaction already refunded</td>
<td>The transaction was previously refunded to the full amount</td>
</tr>
<tr>
<td><code>080</code></td>
<td>Transaction cancelled</td>
<td>The transaction was cancelled</td>
</tr>
<tr>
<td><code>081</code></td>
<td>Transaction timed out</td>
<td>The transaction timed out while processing</td>
</tr>
<tr>
<td><code>082</code></td>
<td>Terminal allocation timed out</td>
<td>The transaction timed out while allocating a terminal id</td>
</tr>
<tr>
<td><code>083</code></td>
<td>Transaction timed out</td>
<td>The transaction timed out while connecting to the acquirer</td>
</tr>
<tr>
<td><code>084</code></td>
<td>Transaction timed out</td>
<td>The transaction timed out while awaiting a response from the acquirer</td>
</tr>
<tr>
<td><code>085</code></td>
<td>Concurrency Limit Reached</td>
<td>The transaction could not be processed as the concurrency levels have been met</td>
</tr>
<tr>
<td><code>087</code></td>
<td>Revocation of Order</td>
<td>The transaction has been revoked by the card holder, and must not retry with the same card details. Alternative payment details should be provided</td>
</tr>
<tr>
<td><code>088</code></td>
<td>Retain Card</td>
<td></td>
</tr>
<tr>
<td><code>089</code></td>
<td>Referred</td>
<td></td>
</tr>
<tr>
<td><code>090</code></td>
<td>Declined Transaction</td>
<td>The transaction was declined by the card issuer.</td>
</tr>
<tr>
<td><code>091</code></td>
<td>Declined Transaction</td>
<td>The transaction was declined due to the card failing the fraud check</td>
</tr>
<tr>
<td><code>092</code></td>
<td>Declined Refund</td>
<td>The refund was declined</td>
</tr>
<tr>
<td><code>093</code></td>
<td>Declined Void Transaction</td>
<td>The void transaction was declined</td>
</tr>
<tr>
<td><code>094</code></td>
<td>Declined Transaction</td>
<td>Transaction Declined. CSC Failure</td>
</tr>
<tr>
<td><code>095</code></td>
<td>Declined Transaction</td>
<td>Transaction Declined. AVS Failure</td>
</tr>
<tr>
<td><code>096</code></td>
<td>Declined Transaction</td>
<td>Transaction Declined. AVS Failure</td>
</tr>
<tr>
<td><code>097</code></td>
<td>Declined Transaction</td>
<td>Transaction Declined. AVS Failure</td>
</tr>
<tr>
<td><code>098</code></td>
<td>Declined Transaction</td>
<td>Transaction Declined. Authentication Failure</td>
</tr>
<tr>
<td><code>B001</code></td>
<td>Batch Processing unavailable</td>
<td>Occurs when batch processing is unavailable for processing</td>
</tr>
<tr>
<td><code>B002</code></td>
<td>Batch does not exist</td>
<td>Occurs when a batch requested does not exist</td>
</tr>
<tr>
<td><code>B003</code></td>
<td>No batch ids provided</td>
<td>The request expects a batch id however no id was found</td>
</tr>
<tr>
<td><code>B004</code></td>
<td>Invalid Batch Id</td>
<td>Occurs when a batch id is an invalid format</td>
</tr>
<tr>
<td><code>B005</code></td>
<td>No transactions on batch</td>
<td>The batch requested has no transactions included</td>
</tr>
<tr>
<td><code>B006</code></td>
<td>Transaction invalid in batch</td>
<td>A transaction has been found to be invalid within the batch preventing processing</td>
</tr>
<tr>
<td><code>B007</code></td>
<td>Batch date is invalid</td>
<td>The batch date provided cannot be parsed or is an invalid date value</td>
</tr>
<tr>
<td><code>B008</code></td>
<td>Batch failed duplication checks</td>
<td>The batch is a duplicate and cannot be processed</td>
</tr>
<tr>
<td><code>B009</code></td>
<td>Batch maximum number of transactions reached</td>
<td>The batch can contain up to 10,000 transactions on production and 100 in sandbox.</td>
</tr>
<tr>
<td><code>C001</code></td>
<td>Card number contains non-numeric character</td>
<td></td>
</tr>
<tr>
<td><code>C002</code></td>
<td>LUHN Check failure</td>
<td>Consider the possibility that the card number was keyed incorrectly</td>
</tr>
<tr>
<td><code>C003</code></td>
<td>Card number missing</td>
<td></td>
</tr>
<tr>
<td><code>C004</code></td>
<td>Card number is an invalid length</td>
<td></td>
</tr>
<tr>
<td><code>C005</code></td>
<td>Card is not yet valid</td>
<td>The start date is in the future.</td>
</tr>
<tr>
<td><code>C006</code></td>
<td>Card has expired</td>
<td>The expiry date is in the past.</td>
</tr>
<tr>
<td><code>C007</code></td>
<td>Card expiry month is not a valid month</td>
<td>Months should be an integer value between 1 and 12</td>
</tr>
<tr>
<td><code>C008</code></td>
<td>Card expiry year is not a valid year</td>
<td>Year values should be either a 2 digit or 4 digit number</td>
</tr>
<tr>
<td><code>C009</code></td>
<td>Expiry date is not YYMM</td>
<td>When providing an expiry date as a String the format should be 2 digit YEAR and 2 digit MONTH (YYMM) for example 0412</td>
</tr>
<tr>
<td><code>C010</code></td>
<td>Expiry data missing</td>
<td></td>
</tr>
<tr>
<td><code>C011</code></td>
<td>Issue number is not numeric</td>
<td></td>
</tr>
<tr>
<td><code>C012</code></td>
<td>CSC Not an Integer</td>
<td></td>
</tr>
<tr>
<td><code>C013</code></td>
<td>CSC is longer than 4 characters</td>
<td></td>
</tr>
<tr>
<td><code>C014</code></td>
<td>CSC Not Present</td>
<td></td>
</tr>
<tr>
<td><code>C015</code></td>
<td>Start date is not YYMM</td>
<td>When providing an expiry date as a String the format should be 2 digit YEAR and 2 digit MONTH (YYMM) for example 0412</td>
</tr>
<tr>
<td><code>C016</code></td>
<td>Card start date month is not a valid month</td>
<td>Months should be an integer value between 1 and 12</td>
</tr>
<tr>
<td><code>C017</code></td>
<td>Card start date year is not a valid year</td>
<td>Year values should be either a 2 digit or 4 digit number</td>
</tr>
<tr>
<td><code>C018</code></td>
<td>Card has previously been charged back</td>
<td></td>
</tr>
<tr>
<td><code>C019</code></td>
<td>Invalid expiry date</td>
<td>The expiry date is so far in the future that it is considered invalid. By default, this error is logged for expiry dates more than 7 years in the future; this offset may be changed by contacting support.</td>
</tr>
<tr>
<td><code>C020</code></td>
<td>Invalid Start Date</td>
<td>The card start date contains an invalid date, invalid characters or has not been entered when required.</td>
</tr>
<tr>
<td><code>C021</code></td>
<td>Card number is invalid</td>
<td>The card number is not a valid number</td>
</tr>
<tr>
<td><code>C022</code></td>
<td>Bin range not found</td>
<td>The card number provided cannot be used for this transaction</td>
</tr>
<tr>
<td><code>C023</code></td>
<td>Unexpected Issue Number</td>
<td>An unexpected issue number is present in the card details</td>
</tr>
<tr>
<td><code>C024</code></td>
<td>Expected Issue Number</td>
<td>An expected issue number is not present in the card details</td>
</tr>
<tr>
<td><code>C025</code></td>
<td>Invalid Issue Number</td>
<td>An invalid issue number is present in the card details</td>
</tr>
<tr>
<td><code>C026</code></td>
<td>CSC Length is invalid for Card</td>
<td>The length of the card security code (CSC,CV2,CVV2) is invalid for the given card type. Visa and Mastercard, generally require a 3 digit code where as American Express require 4 digits.</td>
</tr>
<tr>
<td><code>C027</code></td>
<td>Card has expired</td>
<td>The card is recognised as being expired.</td>
</tr>
<tr>
<td><code>C028</code></td>
<td>Card holder name is mandatory</td>
<td>The card holder name is mandatory and is not supplied.</td>
</tr>
<tr>
<td><code>D001</code></td>
<td>Gateway Not Configured Error</td>
<td>The gateway is not available as there is no configuration data available.</td>
</tr>
<tr>
<td><code>D002</code></td>
<td>Gateway Configuration Error</td>
<td>The gateway is not available as there is a problem with the configuration.</td>
</tr>
<tr>
<td><code>D003</code></td>
<td>Fraud Module Configuration Error</td>
<td>The fraud module is not available as there is a problem with the configuration.</td>
</tr>
<tr>
<td><code>D004</code></td>
<td>Class Instantiation Error</td>
<td>An internal gatway problem.</td>
</tr>
<tr>
<td><code>D005</code></td>
<td>Class Illegal Access Error</td>
<td>An internal gateway problem.</td>
</tr>
<tr>
<td><code>D006</code></td>
<td>Unkown Terminal</td>
<td>The terminal configuration information is invalid.</td>
</tr>
<tr>
<td><code>D007</code></td>
<td>Unauthorised to use this Terminal</td>
<td>The user is not authorised to use this terminal.</td>
</tr>
<tr>
<td><code>D008</code></td>
<td>Terminal Inactive</td>
<td>The terminal being used is currently inactive.</td>
</tr>
<tr>
<td><code>D009</code></td>
<td>Password Invalid</td>
<td>The password being used is invalid.</td>
</tr>
<tr>
<td><code>D010</code></td>
<td>User Invalid</td>
<td>The user is invalid.</td>
</tr>
<tr>
<td><code>D011</code></td>
<td>User does not have permission to perform this operation</td>
<td>User does not have permission to perform this operation</td>
</tr>
<tr>
<td><code>D012</code></td>
<td>Hostile card list is not available</td>
<td>The system cannot retrieve details from the hostile card list</td>
</tr>
<tr>
<td><code>D013</code></td>
<td>Merchant is not found</td>
<td>The merchant number is invalid</td>
</tr>
<tr>
<td><code>D014</code></td>
<td>Card holder must be present</td>
<td>The card holder must be present for this transaction</td>
</tr>
<tr>
<td><code>D015</code></td>
<td>Invalid Currency Code</td>
<td>The currency code provided is not a valid currency code</td>
</tr>
<tr>
<td><code>D016</code></td>
<td>Card type or currency for merchant not found</td>
<td>The card bin range or currency code is not valid for the given merchant.</td>
</tr>
<tr>
<td><code>D017</code></td>
<td>Cardholder must be present</td>
<td>The cardholder must be pressent for this transaction.</td>
</tr>
<tr>
<td><code>D018</code></td>
<td>Card must be present</td>
<td>The card must be pressent for this transaction.</td>
</tr>
<tr>
<td><code>D019</code></td>
<td>Manual entry not allowed for this merchant</td>
<td>The merchant is not allowed to perform a manual entry.</td>
</tr>
<tr>
<td><code>D020</code></td>
<td>Invalid Transaction Type</td>
<td>The transaction type requested is invalid.</td>
</tr>
<tr>
<td><code>D021</code></td>
<td>Transaction not allowed for card</td>
<td>The transaction is not allowed for the given card.</td>
</tr>
<tr>
<td><code>D022</code></td>
<td>Transaction not found for merchant with given trasaction number</td>
<td>A transaction cannot be found for the merchant using the given transaction number.</td>
</tr>
<tr>
<td><code>D023</code></td>
<td>Transaction not found for merchant with given identifier</td>
<td>A transaction cannot be found for the merchant using the given identifier.</td>
</tr>
<tr>
<td><code>D024</code></td>
<td>Decryption currently unavailable</td>
<td>The crypto server cannot be contacted for decryption, decryption requests are unavailable.</td>
</tr>
<tr>
<td><code>D025</code></td>
<td>Encryption currently unavailable</td>
<td>The crypto server cannot be contacted for encryption, encryption requests are unavailable.</td>
</tr>
<tr>
<td><code>D026</code></td>
<td>No batch id presented</td>
<td>A batch id was required to perform the action and was not preset.</td>
</tr>
<tr>
<td><code>D027</code></td>
<td>No client id presented</td>
<td>A client id was required to perform the action and was not preset.</td>
</tr>
<tr>
<td><code>D028</code></td>
<td>None ASCII characters found in data</td>
<td>none ASCII encoded data was found when the data is restricted to the ASCII type.</td>
</tr>
<tr>
<td><code>D029</code></td>
<td>Invalid Encoding Error</td>
<td>The data contains an invalid encoding that is not allowed for the resource.</td>
</tr>
<tr>
<td><code>D030</code></td>
<td>Batch does not contain transactions</td>
<td>The batch presented for processing does not contain any transactions.</td>
</tr>
<tr>
<td><code>D031</code></td>
<td>Store is not found</td>
<td>The store id is invalid</td>
</tr>
<tr>
<td><code>D032</code></td>
<td>Store is inactive</td>
<td>The store defined by the store id is inactive</td>
</tr>
<tr>
<td><code>D033</code></td>
<td>Field value is an invalid signed integer value</td>
<td>The maximum integer value is 0x7fffffff. The provided value is too large</td>
</tr>
<tr>
<td><code>D034</code></td>
<td>Field value is an invalid signed long value</td>
<td>The maximum integer value is 0x7fffffffffffffff. The provided value is too large</td>
</tr>
<tr>
<td><code>D035</code></td>
<td>Field value is an invalid signed short value</td>
<td>The maximum integer value is 32767. The provided value is too large</td>
</tr>
<tr>
<td><code>D036</code></td>
<td>The Card Scheme could not be determined</td>
<td>Check the card pan to confirm that the pan number is correct and that the bin range entry for this card is available</td>
</tr>
<tr>
<td><code>D037</code></td>
<td>Acquirer is unavailable</td>
<td>The acquirer for this request is currently unavailable</td>
</tr>
<tr>
<td><code>D038</code></td>
<td>Gateway route is unavailable</td>
<td>The gateway route for this transaction is currently unavailable. This may be caused by a configuration change, technical fault or planned works</td>
</tr>
<tr>
<td><code>D039</code></td>
<td>No Terminal ID available</td>
<td>A terminal id is required to process a transaction. Dependant on the acquirer this may be due to a limitation of concurrency in processing against the number of allocation terminal IDs to the account.</td>
</tr>
<tr>
<td><code>D040</code></td>
<td>Acquirer Dataset is not found for transaction</td>
<td>No acquirer dataset is configured to handle this transaction</td>
</tr>
<tr>
<td><code>D041</code></td>
<td>3DSecure Currently Unavailable</td>
<td>The ecommerce transaction requires 3DSecure for processing and the Merchant Plug In is currently unavailable. Please retry later</td>
</tr>
<tr>
<td><code>D042</code></td>
<td>3DSecure Enrollment Error</td>
<td>The account is not enrolled fully for 3DSecure</td>
</tr>
<tr>
<td><code>D043</code></td>
<td>3DSecure Configuration Error</td>
<td>The account contains invalid or no configuration information which prevented a 3DSecure session from continuing</td>
</tr>
<tr>
<td><code>D044</code></td>
<td>3DSecure Merchant URI Invalid</td>
<td>The Merchant URI is either blank or invalid for 3DSecure authentication</td>
</tr>
<tr>
<td><code>D045</code></td>
<td>3DSecure Accept Headers Invalid</td>
<td>The Accept Headers is either blank or invalid for 3DSecure authentication</td>
</tr>
<tr>
<td><code>D046</code></td>
<td>3DSecure User Agent Invalid</td>
<td>The User Agent is either blank or invalid for 3DSecure authentication</td>
</tr>
<tr>
<td><code>D047</code></td>
<td>3DSecure Directory Server Comms Failure</td>
<td>A communication failure was realised while contacting the 3dsecure directory server</td>
</tr>
<tr>
<td><code>D048</code></td>
<td>Account Id is Invalid</td>
<td>The account id supplied is not in the required format. Account ids must contain URL sensitive characters only such as [a-zA-Z0-9-_.~]</td>
</tr>
<tr>
<td><code>D049</code></td>
<td>Account Already Exists</td>
<td>The account id provided, already exists and does not allow for accounts with the same id</td>
</tr>
<tr>
<td><code>D050</code></td>
<td>Test Error</td>
<td>An error used for testing purposes</td>
</tr>
<tr>
<td><code>F001</code></td>
<td>Unknown Error</td>
<td></td>
</tr>
<tr>
<td><code>F002</code></td>
<td>Data Error</td>
<td></td>
</tr>
<tr>
<td><code>F003</code></td>
<td>System Error</td>
<td></td>
</tr>
<tr>
<td><code>F004</code></td>
<td>Null error occurred</td>
<td></td>
</tr>
<tr>
<td><code>F005</code></td>
<td>Unknown Transaction Type</td>
<td></td>
</tr>
<tr>
<td><code>F006</code></td>
<td>Upstream Communication Error</td>
<td>The service could not connect to its upstream service. This is normally an indication that an upstream service has a problem. An engineer will be looking into the failure and retry your call later.</td>
</tr>
<tr>
<td><code>F007</code></td>
<td>TID Allocation Timeout</td>
<td></td>
</tr>
<tr>
<td><code>L200</code></td>
<td>The Paylink Session was Completed</td>
<td>The Paylink session has already been processed and is now complete</td>
</tr>
<tr>
<td><code>L201</code></td>
<td>The Paylink Session has expired and can no longer be used</td>
<td>The paylink session is no longer available and has expired</td>
</tr>
<tr>
<td><code>L204</code></td>
<td>The Paylink Session was not found</td>
<td>The session identified by the token appears a valid token but is not found</td>
</tr>
<tr>
<td><code>L401</code></td>
<td>The Paylink Session has been rejected due to a security failure</td>
<td>Security checks have found a problem continuing with the session and prevented further access</td>
</tr>
<tr>
<td><code>L402</code></td>
<td>The requested function on the Paylink Session failed validation</td>
<td>Validation failed for the request possibly due to the parameters used.</td>
</tr>
<tr>
<td><code>L403</code></td>
<td>The Paylink Session is locked.</td>
<td>Field guards reattempts have been breached and may retry later. Field guards have access controls which prevents brute force attacks</td>
</tr>
<tr>
<td><code>P001</code></td>
<td>Response type not set</td>
<td></td>
</tr>
<tr>
<td><code>P002</code></td>
<td>Merchant ID Not Supplied</td>
<td></td>
</tr>
<tr>
<td><code>P003</code></td>
<td>Merchant ID Is Invalid</td>
<td></td>
</tr>
<tr>
<td><code>P004</code></td>
<td>Amount is not supplied</td>
<td></td>
</tr>
<tr>
<td><code>P005</code></td>
<td>Amount is invalid</td>
<td>The transaction amount sent in the transaction request is invalid because it is too long or contains characters other than digits.</td>
</tr>
<tr>
<td><code>P006</code></td>
<td>Amount is not supplied in the lowest denomination</td>
<td></td>
</tr>
<tr>
<td><code>P007</code></td>
<td>The request is not from an accepted source</td>
<td></td>
</tr>
<tr>
<td><code>P008</code></td>
<td>The referal source is unknown</td>
<td>This error occurs when the system cannot identify the source of the request (IP or HTTP Header).</td>
</tr>
<tr>
<td><code>P009</code></td>
<td>AVS Postcode is not supplied</td>
<td></td>
</tr>
<tr>
<td><code>P010</code></td>
<td>AVS Postcode greater than 8 characters</td>
<td>The AVS value contains too many numeric values</td>
</tr>
<tr>
<td><code>P011</code></td>
<td>AVS Address is not supplied</td>
<td></td>
</tr>
<tr>
<td><code>P012</code></td>
<td>AVS Address greater than 8 characters</td>
<td>The AVS value contains too many numeric values</td>
</tr>
<tr>
<td><code>P013</code></td>
<td>Transaction Id or Identifier not Present</td>
<td></td>
</tr>
<tr>
<td><code>P014</code></td>
<td>Transaction Id not Numeric</td>
<td>The transaction ID should be a numeric value</td>
</tr>
<tr>
<td><code>P015</code></td>
<td>Ceiling Limit Exceeded</td>
<td>The transaction amount for this transaction request is above the ceiling limit for the relevant Merchant.</td>
</tr>
<tr>
<td><code>P016</code></td>
<td>Identifier is greater than 50 characters</td>
<td>The identifier must be an alphanumeric value up to 50 characters in length</td>
</tr>
<tr>
<td><code>P017</code></td>
<td>LicenceKey is greater than 255 characters</td>
<td>The licencekey value must be an alphanumeric value up to 255 characters in length</td>
</tr>
<tr>
<td><code>P018</code></td>
<td>Invalid transaction type</td>
<td>The transaction type is not allowed for this merchant</td>
</tr>
<tr>
<td><code>P019</code></td>
<td>Validation Code Error</td>
<td>The request failed the validation code test and is deemed to be an insecure request</td>
</tr>
<tr>
<td><code>P020</code></td>
<td>Cashback amount is invalid</td>
<td>The cash amount sent in the transaction request is invalid because it is too long or contains characters other than digits.</td>
</tr>
<tr>
<td><code>P021</code></td>
<td>Cashback transaction not permitted</td>
<td>Transaction requested cashback and the Merchant does not allow cashback transactions for the credit/debit card tendered.</td>
</tr>
<tr>
<td><code>P022</code></td>
<td>Cashback ceiling limit exceeded</td>
<td>The cash amount for this transaction request is above the ceiling limit for the relevant MerchantID.</td>
</tr>
<tr>
<td><code>P023</code></td>
<td>Invalid transaction type code</td>
<td>The transaction request does not have a valid Transaction Type code.</td>
</tr>
<tr>
<td><code>P024</code></td>
<td>Void Transaction failed, invalid orginal transaction</td>
<td>The request for a void transaction failed due to the original transaction not being valid.</td>
</tr>
<tr>
<td><code>P025</code></td>
<td>Void Transaction failed, no valid original authcode</td>
<td>The request for a void transaction failed due to the original transaction not hvaing a valid authorisation code.</td>
</tr>
<tr>
<td><code>P026</code></td>
<td>Identifier is not supplied</td>
<td>The transaction identifier was not supplied by the merchant.</td>
</tr>
<tr>
<td><code>P027</code></td>
<td>Email address is not supplied</td>
<td>The email address is required and was not supplied by the merchant.</td>
</tr>
<tr>
<td><code>P028</code></td>
<td>Product information is not supplied</td>
<td>Product Information is required for this transaction and was not supplied by the merchant.</td>
</tr>
<tr>
<td><code>P029</code></td>
<td>Authorisation key is not supplied</td>
<td>An authorisation key is required for this request and was not supplied</td>
</tr>
<tr>
<td><code>P030</code></td>
<td>Authorisation invalid</td>
<td></td>
</tr>
<tr>
<td><code>P031</code></td>
<td>Unsupported transaction type</td>
<td>The transaction type requested is not supported by the gateway.</td>
</tr>
<tr>
<td><code>P032</code></td>
<td>Transaction type not available for processing</td>
<td>The transaction type is not configured for the merchant.</td>
</tr>
<tr>
<td><code>P033</code></td>
<td>Card scheme not available for processing</td>
<td>The card scheme is not configured for the merchant.</td>
</tr>
<tr>
<td><code>P034</code></td>
<td>Invalid Currency</td>
<td>The currency specified is invalid.</td>
</tr>
<tr>
<td><code>P035</code></td>
<td>Licence key is not supplied</td>
<td>The Licence key is required for processing and was not supplied.</td>
</tr>
<tr>
<td><code>P036</code></td>
<td>Licence key does not match</td>
<td>The Licence key was supplied but did not match the key required for processing.</td>
</tr>
<tr>
<td><code>P037</code></td>
<td>Licence key invalid</td>
<td>The Licence key was supplied and was not a valid key.</td>
</tr>
<tr>
<td><code>P038</code></td>
<td>Floor limit not reached</td>
<td>The floor limit was not reached for processing the transaction.</td>
</tr>
<tr>
<td><code>P039</code></td>
<td>Identifier is less than 5 characters</td>
<td>The identifier must be an alphanumeric value 5 or more characters in length</td>
</tr>
<tr>
<td><code>P040</code></td>
<td>Account Number Not Supplied</td>
<td>A card holder account number was not supplied and therefore the transaction cannot continue</td>
</tr>
<tr>
<td><code>P041</code></td>
<td>Account Number is an invalid length</td>
<td>A card holder account number is an invalid length</td>
</tr>
<tr>
<td><code>P042</code></td>
<td>Account Number contains invalid characters</td>
<td>A card holder account number contains non ascii characters or contains spaces surrounding the value</td>
</tr>
<tr>
<td><code>P043</code></td>
<td>Account Number not found</td>
<td>A card holder account was not found for the given request. Please check the account number and/or password is correct</td>
</tr>
<tr>
<td><code>P044</code></td>
<td>Field not provided</td>
<td>The given field was not provided and is required. Please check the documentation provided with your installation instructions.</td>
</tr>
<tr>
<td><code>P045</code></td>
<td>Field value invalid</td>
<td>The given field value is invalid. Please check the documentation provided with your installation instructions.</td>
</tr>
<tr>
<td><code>P046</code></td>
<td>Cart Invalid Mode</td>
<td>The given cart mode is not valid</td>
</tr>
<tr>
<td><code>P047</code></td>
<td>Cart Contains No Items</td>
<td>The cart items are required for the cart mode and contains no items</td>
</tr>
<tr>
<td><code>P048</code></td>
<td>Cart Amount Invalid</td>
<td>The amounts in the cart are not valid, please ensure each amount is &gt; 0</td>
</tr>
<tr>
<td><code>P049</code></td>
<td>Account is Not Active</td>
<td>The card holder account is not active and cannot be used used.</td>
</tr>
<tr>
<td><code>P050</code></td>
<td>Account has not been verified</td>
<td>The card holder account has not yet been verified. Please verify before using the account.</td>
</tr>
<tr>
<td><code>P051</code></td>
<td>Token has expired</td>
<td>The payment token has expired and can no longer be used</td>
</tr>
<tr>
<td><code>P052</code></td>
<td>Token is not valid</td>
<td>The token is not valid and cannot be decoded</td>
</tr>
<tr>
<td><code>P053</code></td>
<td>Token card not found</td>
<td>The token has been understood but no active card has been found that can be used for this token</td>
</tr>
<tr>
<td><code>R001</code></td>
<td>Could not identify the original transaction</td>
<td></td>
</tr>
<tr>
<td><code>R002</code></td>
<td>Transaction Exceeds original value</td>
<td></td>
</tr>
<tr>
<td><code>R003</code></td>
<td>Transaction has already been refunded</td>
<td></td>
</tr>
<tr>
<td><code>R004</code></td>
<td>Error retrieving original amount</td>
<td></td>
</tr>
<tr>
<td><code>R005</code></td>
<td>The amount to refund exceeds the amount available to refund</td>
<td></td>
</tr>
<tr>
<td><code>R006</code></td>
<td>Refund not permitted for MerchantID</td>
<td>Transaction requested a refund and the Merchant does not allow refunds on the credit/debit card tendered.</td>
</tr>
<tr>
<td><code>R007</code></td>
<td>Transaction number is not a valid number</td>
<td>The transaction number provided is invalid for the request and must be a valid integer.</td>
</tr>
<tr>
<td><code>R008</code></td>
<td>Refund Security Code invalid</td>
<td>The refund security code was provided but did not match the required security code for the provided merchant id</td>
</tr>
<tr>
<td><code>R009</code></td>
<td>Refund Security Code Not Provided</td>
<td>The refund security code was not provided and is required to perform a refund.</td>
</tr>
<tr>
<td><code>R010</code></td>
<td>Original transaction is not a valid purchase</td>
<td>The transaction cannot be refunded because the original transaction is not a valid purchase.</td>
</tr>
<tr>
<td><code>R011</code></td>
<td>Original transaction was not accepted</td>
<td>The transaction cannot be refunded because the original transaction was not accepted.</td>
</tr>
<tr>
<td><code>S001</code></td>
<td>Invalid Client ID</td>
<td>The client id provided is invalid</td>
</tr>
<tr>
<td><code>S002</code></td>
<td>Invalid Merchant ID</td>
<td>The merchant id provided is invalid</td>
</tr>
<tr>
<td><code>S003</code></td>
<td>Invalid Merchant and Client ID Combination</td>
<td>Either the merchant id or client id provided is invalid for this request</td>
</tr>
<tr>
<td><code>S004</code></td>
<td>General Authentication Failure</td>
<td>The authentication failed for the requested service.</td>
</tr>
<tr>
<td><code>S005</code></td>
<td>Not Authorised</td>
<td>You are not authorised to perform the operation</td>
</tr>
<tr>
<td><code>S006</code></td>
<td>Not Licenced</td>
<td>You are not licenced to perform this operation</td>
</tr>
<tr>
<td><code>S007</code></td>
<td>Authentication Required</td>
<td>Authentication is required to perform this operation and no authentication was presented for authorisation.</td>
</tr>
<tr>
<td><code>S008</code></td>
<td>Invalid Licence Key</td>
<td>The given licence key is invalid.</td>
</tr>
<tr>
<td><code>S009</code></td>
<td>Risk Generation Threshold Limit Reached.</td>
<td>Risk has determined that the request cannot be completed due to too many attempts during the period.</td>
</tr>
<tr>
<td><code>S010</code></td>
<td>Invalid Mac</td>
<td>The provided Message Authentication Code is not valid and the integrity of the request is not confirmed.</td>
</tr>
<tr>
<td><code>T001</code></td>
<td>Duplicate Transaction Error</td>
<td>A transaction with the same transaction reference and card details has been provided</td>
</tr>
<tr>
<td><code>T002</code></td>
<td>Transaction exceeds required level</td>
<td></td>
</tr>
<tr>
<td><code>T003</code></td>
<td>Transaction is not a valid capture</td>
<td>An invalid capture request was requested.</td>
</tr>
<tr>
<td><code>T004</code></td>
<td>Transaction is not a valid reversal</td>
<td>An invalid reversal request was requested.</td>
</tr>
<tr>
<td><code>T005</code></td>
<td>3D Secure Authentication Error</td>
<td>Caused when the PARes fails digital signature validation.</td>
</tr>
<tr>
<td><code>T006</code></td>
<td>3D Secure Authentication Required</td>
<td>A transaction is required to be fully authorised using 3d secure by returning a valid CAVV and AuthenticationResult=Y</td>
</tr>
<tr>
<td><code>T007</code></td>
<td>Pre-Auth not available for card scheme</td>
<td>Caused when the card scheme is not able to perform pre-authorisation requests.</td>
</tr>
<tr>
<td><code>T008</code></td>
<td>Pre-Auth not available for Acquirer</td>
<td>Caused when the Acquirer is not able to perform pre-authorisation requests.</td>
</tr>
<tr>
<td><code>T009</code></td>
<td>Transaction already cancelled</td>
<td>Caused when the transaction has already been cancelled</td>
</tr>
<tr>
<td><code>T010</code></td>
<td>Cannot cancel pre-auth transaction</td>
<td>Caused when the transaction is not available to be cancelled</td>
</tr>
<tr>
<td><code>T011</code></td>
<td>Transaction already completed</td>
<td>Caused when the transaction has already been completed</td>
</tr>
<tr>
<td><code>T012</code></td>
<td>Cannot complete pre-auth transaction</td>
<td>Caused when the transaction is not available to be completed</td>
</tr>
<tr>
<td><code>T013</code></td>
<td>Transaction was not authorised</td>
<td>A post authorisation action has found that the original transaction was not authorised and therefore the action cannot be completed</td>
</tr>
<tr>
<td><code>W001</code></td>
<td>Tokens amount not present</td>
<td></td>
</tr>
<tr>
<td><code>W002</code></td>
<td>Tokens Amount Not an Integer</td>
<td></td>
</tr>
<tr>
<td><code>W003</code></td>
<td>Email Address Not Supplied</td>
<td></td>
</tr>
<tr>
<td><code>W004</code></td>
<td>PostCode/ZipCode Not Supplied</td>
<td></td>
</tr>
<tr>
<td><code>W005</code></td>
<td>Country Not Present</td>
<td></td>
</tr>
<tr>
<td><code>W006</code></td>
<td>Town/City Not Present</td>
<td></td>
</tr>
<tr>
<td><code>W007</code></td>
<td>First Address Line Not Supplied</td>
<td></td>
</tr>
<tr>
<td><code>W008</code></td>
<td>Last Name Not Supplied</td>
<td></td>
</tr>
<tr>
<td><code>W009</code></td>
<td>First Name Not Supplied</td>
<td></td>
</tr>
<tr>
<td><code>W010</code></td>
<td>Password not supplied</td>
<td></td>
</tr>
<tr>
<td><code>W011</code></td>
<td>Password Must be at least 8 chars</td>
<td></td>
</tr>
<tr>
<td><code>W012</code></td>
<td>An error occurred creating the account</td>
<td></td>
</tr>
<tr>
<td><code>W013</code></td>
<td>Could not find a wallet from the given criteria</td>
<td></td>
</tr>
<tr>
<td><code>W014</code></td>
<td>An error occurred obtaining the wallet</td>
<td></td>
</tr>
<tr>
<td><code>W015</code></td>
<td>Wallet is de-activated</td>
<td></td>
</tr>
<tr>
<td><code>W016</code></td>
<td>Password contains illegal characters</td>
<td>The password can only contain alphanumeric characters with no spaces</td>
</tr>
<tr>
<td><code>W017</code></td>
<td>Ceiling Limit Exceeded</td>
<td></td>
</tr>
<tr>
<td><code>W018</code></td>
<td>Error purchasing tokens</td>
<td></td>
</tr>
<tr>
<td><code>W019</code></td>
<td>Error redeeming tokens</td>
<td></td>
</tr>
<tr>
<td><code>W020</code></td>
<td>Redirect address is invalid</td>
<td></td>
</tr>
<tr>
<td><code>W021</code></td>
<td>Merchant ID is invalid</td>
<td></td>
</tr>
<tr>
<td><code>W022</code></td>
<td>Merchant ID is not supplied</td>
<td></td>
</tr>
<tr>
<td><code>W023</code></td>
<td>Request was from an invalid source</td>
<td></td>
</tr>
<tr>
<td><code>W024</code></td>
<td>Terms and conditions were not agreed to</td>
<td>The customer failed to check the terms and conditions checkbox.</td>
</tr>
<tr>
<td><code>W025</code></td>
<td>Floor limit not reached</td>
<td>The amount is not greater than the floor limit set for your account.</td>
</tr>
<tr>
<td><code>Z001</code></td>
<td>The requested service is not available</td>
<td>The service that has been requested is not licenced or enabled on the given account. Retrying will not alter the result.</td>
</tr>
<tr>
<td><code>Z002</code></td>
<td>The requested service is not active</td>
<td>The service that has been requested is licenced however it is not enabled on the given account. Retrying will not alter the result.</td>
</tr>
<tr>
<td><code>Z003</code></td>
<td>The requested service is not permitted</td>
<td>The service that has been requested is not permitted based on your current call this may be due to the source of your call or the environment used.</td>
</tr>
</tbody></table>
<h2 id='auth-result-codes'>Auth Result Codes</h2>
<p>The CityPay Payment API uses the following authorisation result codes in its response messages:</p>

<table><thead>
<tr>
<th>Code</th>
<th>Name</th>
</tr>
</thead><tbody>
<tr>
<td><code>0</code></td>
<td>Declined</td>
</tr>
<tr>
<td><code>1</code></td>
<td>Accepted</td>
</tr>
<tr>
<td><code>2</code></td>
<td>Rejected</td>
</tr>
<tr>
<td><code>3</code></td>
<td>NotAttempted</td>
</tr>
<tr>
<td><code>4</code></td>
<td>Referred</td>
</tr>
<tr>
<td><code>5</code></td>
<td>PinRetry</td>
</tr>
<tr>
<td><code>6</code></td>
<td>ForceSigVerify</td>
</tr>
<tr>
<td><code>7</code></td>
<td>Hold</td>
</tr>
<tr>
<td><code>8</code></td>
<td>SecurityError</td>
</tr>
<tr>
<td><code>9</code></td>
<td>CallAcquirer</td>
</tr>
<tr>
<td><code>10</code></td>
<td>DoNotHonour</td>
</tr>
<tr>
<td><code>11</code></td>
<td>RetainCard</td>
</tr>
<tr>
<td><code>12</code></td>
<td>ExpiredCard</td>
</tr>
<tr>
<td><code>13</code></td>
<td>InvalidCardNo</td>
</tr>
<tr>
<td><code>14</code></td>
<td>PinTriesExceeded</td>
</tr>
<tr>
<td><code>15</code></td>
<td>PinInvalid</td>
</tr>
<tr>
<td><code>16</code></td>
<td>AuthReq</td>
</tr>
<tr>
<td><code>17</code></td>
<td>AuthFail</td>
</tr>
<tr>
<td><code>18</code></td>
<td>Verified</td>
</tr>
<tr>
<td><code>19</code></td>
<td>Cancelled</td>
</tr>
<tr>
<td><code>20</code></td>
<td>Unknown</td>
</tr>
<tr>
<td><code>21</code></td>
<td>Challenged</td>
</tr>
<tr>
<td><code>22</code></td>
<td>Decoupled</td>
</tr>
<tr>
<td><code>23</code></td>
<td>PermissionDenied</td>
</tr>
</tbody></table>
<h2 id='avs-result-codes'>AVS Result Codes</h2>
<p>The CityPay Payment API uses the following AVS result codes in its response messages:</p>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>Z</code></td>
<td>5 digit post code matches, Address does not</td>
</tr>
<tr>
<td><code>Y</code></td>
<td>Address and 5 digit post code match</td>
</tr>
<tr>
<td><code>X</code></td>
<td>Postcode and address match</td>
</tr>
<tr>
<td><code>W</code></td>
<td>9 digit post code matches, Address does not</td>
</tr>
<tr>
<td><code>U</code></td>
<td>No AVS data available from issuer auth system</td>
</tr>
<tr>
<td><code>S</code></td>
<td>AVS Service not supported by issuer or processor</td>
</tr>
<tr>
<td><code>R</code></td>
<td>Retry, System unavailble or Timed Out</td>
</tr>
<tr>
<td><code>P</code></td>
<td>Postal codes match. Street address not verified due to to incompatible formats</td>
</tr>
<tr>
<td><code>N</code></td>
<td>Neither postcode nor address match</td>
</tr>
<tr>
<td><code>M</code></td>
<td>Street address and Postal codes match for international transaction</td>
</tr>
<tr>
<td><code>I</code></td>
<td>Address information verified for international transaction</td>
</tr>
<tr>
<td><code>G</code></td>
<td>Issuer does not participate in AVS</td>
</tr>
<tr>
<td><code>E</code></td>
<td>AVS Error</td>
</tr>
<tr>
<td><code>D</code></td>
<td>Street address and postal codes match</td>
</tr>
<tr>
<td><code>C</code></td>
<td>Street address and Postal code not verified due to incompatible formats</td>
</tr>
<tr>
<td><code>B</code></td>
<td>Postal code not verified due to incompatible formats</td>
</tr>
<tr>
<td><code>A</code></td>
<td>Addres matches, post code does not</td>
</tr>
<tr>
<td><code></code></td>
<td>No information</td>
</tr>
</tbody></table>
<h2 id='csc-result-codes'>CSC Result Codes</h2>
<p>The CityPay Payment API uses the following CSC result codes in its response messages:</p>

<table><thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td><code>U</code></td>
<td>The card issuer is not certified</td>
</tr>
<tr>
<td><code>S</code></td>
<td>The card verification data should be on the card but the merchant indicates that it is not</td>
</tr>
<tr>
<td><code>P</code></td>
<td>Card verification was not processed</td>
</tr>
<tr>
<td><code>N</code></td>
<td>Card verification data was checked but did not match</td>
</tr>
<tr>
<td><code>M</code></td>
<td>Card verification data matches</td>
</tr>
<tr>
<td><code></code></td>
<td>No information</td>
</tr>
</tbody></table>
<h2 id='enabled-tls-ciphers'>Enabled TLS Ciphers</h2>
<p>This API supports the following negotiated ciphers. Most modern HTTP clients will negotiate these ciphers with no additional requirements.</p>

<table><thead>
<tr>
<th>Priority</th>
<th>Cipher</th>
</tr>
</thead><tbody>
<tr>
<td>1</td>
<td>ECDHE-ECDSA-AES128-GCM-SHA256</td>
</tr>
<tr>
<td>2</td>
<td>ECDHE-RSA-AES128-GCM-SHA256</td>
</tr>
<tr>
<td>3</td>
<td>ECDHE-ECDSA-AES128-SHA256</td>
</tr>
<tr>
<td>4</td>
<td>ECDHE-RSA-AES128-SHA256</td>
</tr>
<tr>
<td>5</td>
<td>ECDHE-ECDSA-AES128-SHA</td>
</tr>
<tr>
<td>6</td>
<td>ECDHE-RSA-AES128-SHA</td>
</tr>
<tr>
<td>7</td>
<td>ECDHE-ECDSA-AES256-GCM-SHA384</td>
</tr>
<tr>
<td>8</td>
<td>ECDHE-RSA-AES256-GCM-SHA384</td>
</tr>
<tr>
<td>9</td>
<td>ECDHE-ECDSA-AES256-SHA384</td>
</tr>
<tr>
<td>10</td>
<td>ECDHE-RSA-AES256-SHA384</td>
</tr>
<tr>
<td>11</td>
<td>ECDHE-RSA-AES256-SHA</td>
</tr>
<tr>
<td>12</td>
<td>ECDHE-ECDSA-AES256-SHA</td>
</tr>
</tbody></table>
<h2 id='timeout-handling'>Timeout Handling</h2>
<p>Payment processing with CityPay is ordinarily relatively fast with a response of 200ms - 2000ms. Due to the complexity
of third party processing, transactions occasionally may take longer than usual. We therefore recommended that you
set your time out settings to a relatively long period such as 120 seconds.</p>

<p>Whilst we do not say that a transaction will take this long, it ensures that your connected socket wil not drop the
connection before a response is returned. Should your socket close before the transaction is completed and timeout settings on our side are not yet activated, a transaction may still process and settle without your systems obtaining a response.</p>
<h2 id='testing-best-practices'>Testing Best Practices</h2>
<p>CityPay offer a test facility for client testing and integration development on this API all testing should 
be geared within the sandbox service. This service models an acquirer and produces test transactions for 
testing of post authorisation processes.</p>

<p>Test transactions are available for reporting purposes for up to 3 months.</p>

<p>Our test gateway includes:</p>

<ul>
<li>Test Authorisation processing</li>
<li>Test Refund processing</li>
<li>Test ThreeDSecure v1 ACS for integrating the full authentication process in to your application</li>
<li>Test Pre-auth processes such as authorisation, completion/capture and cancellation/voids</li>
<li>Test Charge processing</li>
</ul>

<p>We are currently working on a ThreeDSecure v2 test integration system.</p>
<h3 id='authorisation-codes-on-the-test-gateway'>Authorisation Codes on the Test Gateway</h3>
<p>Authorisation codes are static to allow the integrator to easily identify an actual 
authorisation code and a test code. The returned authorisation codes by the test gateway are:</p>

<table><thead>
<tr>
<th>AuthCode</th>
<th>Behaviour</th>
</tr>
</thead><tbody>
<tr>
<td>A12345</td>
<td>Sale transaction</td>
</tr>
<tr>
<td>B12345</td>
<td>PreAuth sale transaction</td>
</tr>
<tr>
<td>C12345</td>
<td>Completion/Capture call</td>
</tr>
<tr>
<td>R12345</td>
<td>Refund transaction</td>
</tr>
<tr>
<td>V12345</td>
<td>Void transaction</td>
</tr>
</tbody></table>
<h3 id='modelling-behaviour'>Modelling behaviour</h3>
<p>To model different behaviours, we have enabled both an amount mapping and a csc mapping  process which will return
 different responses based on these values, values are:</p>

<table><thead>
<tr>
<th>Amount</th>
<th>CSC</th>
<th>Behaviour</th>
<th>Response</th>
</tr>
</thead><tbody>
<tr>
<td>3333</td>
<td>333</td>
<td>Returns a declined transaction</td>
<td><code>090</code></td>
</tr>
<tr>
<td>3344</td>
<td>344</td>
<td>Returns an AVS Address Failure, regardless of configuration for AVS and the address value supplied</td>
<td><code>095</code></td>
</tr>
<tr>
<td>3355</td>
<td>355</td>
<td>Returns an AVS Postcode Failure, regardless of configuration for AVS and the address value supplied</td>
<td><code>096</code></td>
</tr>
<tr>
<td>3366</td>
<td>366</td>
<td>Returns a Card Security Failure, regardless of configuration for CSC and the value supplied</td>
<td><code>094</code></td>
</tr>
<tr>
<td>3377</td>
<td>377</td>
<td>Returns a Fraud decline</td>
<td><code>091</code></td>
</tr>
<tr>
<td>4444</td>
<td>444</td>
<td>Returns a Referral</td>
<td><code>089</code></td>
</tr>
<tr>
<td>6666</td>
<td>666</td>
<td>Returns a communication error</td>
<td><code>F006</code></td>
</tr>
<tr>
<td>5544</td>
<td>544</td>
<td>Returns an AVS Address Failure only if AVS is configured or enforced via the API. A value of 99 will reject the address any other value is accepted</td>
<td><code>095</code></td>
</tr>
<tr>
<td>5555</td>
<td>555</td>
<td>Returns an AVS Postcode Failure only if AVS is configured or enforced via the API. A value of 99 will reject the postcode, any other value is accepted</td>
<td><code>096</code></td>
</tr>
<tr>
<td>5566</td>
<td>566</td>
<td>Returns a Card Security Failure only if CSC matching is configured or enforced via the API. A value of 999 will reject the CSC, any other value is accepted</td>
<td><code>094</code></td>
</tr>
</tbody></table>

<p>For American Express cards requiring 4 digit CSC values, the last 3 digits of the CSC will be considered i.e. <code>0333</code>, <code>1333</code> 
would result in the same behaviour.</p>
<h3 id='test-card-numbers'>Test Card Numbers</h3>
<p>The following test card numbers could be used for transaction testing</p>

<table><thead>
<tr>
<th>Card Number</th>
<th>Scheme</th>
<th>Type</th>
<th>CSC Length</th>
</tr>
</thead><tbody>
<tr>
<td><code>3743 871880 19714</code></td>
<td><i class="fa fa-cc-amex" aria-hidden="true"></i> Amex</td>
<td>Credit</td>
<td>4</td>
</tr>
<tr>
<td><code>3014 445396 5469</code></td>
<td><i class="fa fa-cc-diners-club" aria-hidden="true"></i> Diners</td>
<td>Credit</td>
<td>3</td>
</tr>
<tr>
<td><code>3528 0000 0000 0007</code></td>
<td><i class="fa fa-cc-jcb" aria-hidden="true"></i> JCB</td>
<td>Credit</td>
<td>3</td>
</tr>
<tr>
<td><code>4000 0000 0000 0002</code></td>
<td><i class="fa fa-cc-visa" aria-hidden="true"></i> Visa</td>
<td>Credit</td>
<td>3</td>
</tr>
<tr>
<td><code>4659 0100 0000 0005</code></td>
<td><i class="fa fa-cc-visa" aria-hidden="true"></i> Visa</td>
<td>Debit</td>
<td>3</td>
</tr>
<tr>
<td><code>5100 0000 0000 0008</code></td>
<td><i class="fa fa-cc-mastercard" aria-hidden="true"></i> MasterCard</td>
<td>Credit</td>
<td>3</td>
</tr>
<tr>
<td><code>5573 4700 0000 0001</code></td>
<td><i class="fa fa-cc-mastercard" aria-hidden="true"></i> MasterCard</td>
<td>Debit</td>
<td>3</td>
</tr>
<tr>
<td><code>6333 1100 0000 0002</code></td>
<td><i class="fa fa-cc-mastercard" aria-hidden="true"></i> Maestro</td>
<td>Debit</td>
<td>3</td>
</tr>
<tr>
<td><code>4508 7500 0000 0009</code></td>
<td><i class="fa fa-cc-visa" aria-hidden="true"></i> Visa Electron</td>
<td>Debit</td>
<td>3</td>
</tr>
<tr>
<td><code>4857 7900 0000 0002</code></td>
<td><i class="fa fa-cc-visa" aria-hidden="true"></i> Visa Business</td>
<td>Debit</td>
<td>3</td>
</tr>
</tbody></table>
<h2 id='avs-checking'>AVS Checking</h2>
<p>AVS checks the numeric values of the address and postcode via the card issuer and card schemes. Our 
test gateway will only validate whether values are supplied where required. </p>

      </div>
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
                <a href="#" data-language-name="xml">xml</a>
          </div>
    </div>
    <script type="text/javascript">
        var ls = $('.lang-selector:first');
        $('pre.highlight').prepend(ls);
        $('div.requestModel').next('table').addClass('requestModel');
        $('div.responseModel').next('table').addClass('responseModel');
    </script>
  </body>
</html>